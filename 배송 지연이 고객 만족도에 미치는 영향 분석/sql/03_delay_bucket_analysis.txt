SELECT
	CASE
		WHEN delay_days <= 0 THEN 'On time or early'
		WHEN delay_days BETWEEN 1 AND 3 THEN 'Delay 1-3 days'
		WHEN delay_days BETWEEN 4 AND 7 THEN 'Delay 4-7 days'
		ELSE 'Delay 8+ days'
	END AS delay_bucket,
	COUNT(*) AS orders,
	AVG(review_score) AS avg_review_score
FROM
	`raw data`.v_analysis_base
WHERE
	review_score IS NOT NULL
GROUP BY
	delay_bucket
ORDER BY
	CASE
		delay_bucket
    WHEN 'On time or early' THEN 1
		WHEN 'Delay 1-3 days' THEN 2
		WHEN 'Delay 4-7 days' THEN 3
		ELSE 4
	END
;